## 線形静解析 (弾性)

本解析の実施には、`tutorial/01_elastic_hinge` のデータを用います。

### 解析対象

解析対象はヒンジ部品で、形状を図4.1.1に、メッシュデータを図4.1.2に示します。

| 項目       | 内容                | 備考                        | 参照 |
|------------|---------------------|-----------------------------|------|
| 解析の種別 | 線形静解析          | !SOLUTION,TYPE=STATIC       |      |
| 節点数     | 84,056              |                             |      |
| 要素数     | 49,871              |                             |      |
| 要素タイプ | 10節点四面体2次要素 | !ELEMENT,TYPE=342           |[要素ライブラリ](../analysis/analysis_02.html#_2) |
| 材料物性名 | STEEL               | !MATERIAL,NAME=STEEL        |[材料データ](../analysis/analysis_02.html#_12)|
| 材料性質   | ELASTIC             | !ELASTIC                    |      |
| 境界条件   | 拘束,集中荷重       |                             |      |
| 行列解法   | CG/SSOR             | !SOLVER,METHOD=CG,PRECOND=1 |      |

![ヒンジ部品の形状](./media/tutorial01_01.png){.center width="350px"}
<div style="text-align: center;">
図4.1.1　ヒンジ部品の形状
</div>

![ヒンジ部品のメッシュデータ](./media/tutorial01_02.png){.center width="350px"}
<div style="text-align: center;">
図4.1.2　ヒンジ部品のメッシュデータ
</div>

### 解析内容

FrontISTRのソースコードを展開し、本例題のディレクトリへ移動し解析に必要なファイル


  | ファイル名       | 種別           | 役割                                                       |
  |------------------|----------------|------------------------------------------------------------|
  | `hecmw_ctrl.dat` | 全体制御データ | メッシュデータと解析制御データの入出力ファイルを指定します |
  | `hinge.cnt`      | 解析制御データ | 解析の種別、変位境界条件、集中荷重等を定義し、ソルバーやビジュアライザーの制御も指定します |
  | `hinge.msh`      | メッシュデータ | 有限要素メッシュを定義し、その材料データとセクションデータを定義します |

が有るか確認してください。

```
$ tar xvf FrontISTR.tar.gz
$ cd FrontISTR/tutorial/01_elastic_hinge
$ ls
hecmw_ctrl.dat  hinge.cnt  hinge.msh
```

図4.1.1に示す拘束面の変位を拘束し、強制面に集中荷重を負荷する応力解析を実施します。
全体制御データと解析制御データを以下に示します。

#### 全体制御データ `hecmw_ctrl.dat`

メッシュデータと解析制御データの入出力ファイルを指定します。

```
#
# for solver
#
!MESH, NAME=fstrMSH, TYPE=HECMW-ENTIRE # 単一メッシュデータを指定
 hinge.msh
!CONTROL, NAME=fstrCNT                 # 解析制御データを指定
 hinge.cnt
!RESULT, NAME=fstrRES, IO=OUT          # 結果データを指定
 hinge.res
!RESULT, NAME=vis_out, IO=OUT          # 可視化データを指定
 hinge_vis
```

#### 解析制御データ `hinge.cnt`

解析の種別、変位境界条件、集中荷重等を定義し、ソルバーやビジュアライザーの制御も指定します。

```
#  Control File for FISTR
## Analysis Control
!VERSION                   # ファイルフォーマットのバージョンを指定
 3
!SOLUTION, TYPE=STATIC     # 解析の種別を指定
!WRITE,RESULT              # 結果データ出力の指定
!WRITE,VISUAL              # 可視化データの出力を指定
## Solver Control
### Boundary Conditon
!BOUNDARY
 BND0, 1, 3, 0.000000      # 拘束面1を指定
!BOUNDARY
 BND1, 1, 3, 0.000000      # 拘束面2を指定
!CLOAD
 CL0, 1, 0.01000           # 強制面を指定
### Material
!MATERIAL, NAME=STEEL      # 材料物性の指定
!ELASTIC                   # 弾性物質の定義
 210000.0, 0.3
!DENSITY                   # 質量密度の定義
 7.85e-6
### Solver Setting
!SOLVER,METHOD=CG,PRECOND=1,ITERLOG=YES,TIMELOG=YES  # ソルバーの制御
 10000, 1
 1.0e-08, 1.0, 0.0
## Post Control
!VISUAL,metod=PSR           # 可視化手法の指定
!surface_num=1              # 1つのサーフェースレンダリング内のサーフェース数
!surface 1                  # サーフェースの内容の指定
!output_type=VTK            # 可視化ファイルの型の指定
!END                        # 解析制御データの終わりを示す
```

#### メッシュデータ

有限要素メッシュを定義し、その材料データとセクションデータを定義します。

(一部のみ)

```
!HEADER
 HECMW_Msh File generated by REVOCAP
!NODE
       1,    -1.22042,     2.23355,     1.65220
       2,    -1.27050,    -3.10529,     1.59209
...
!ELEMENT, TYPE=342
       1,    1157,    3549,    3321,    3739,   12629,   12627,   12626,   12628,   12631,   12630
       2,    8207,    3321,    3549,    3739,   12629,   12633,   12632,   12634,   12630,   12631
...
!MATERIAL, NAME=STEEL, ITEM=2
!ITEM=1, SUBITEM=2
210000.0, 0.3
!ITEM=2, SUBITEM=1
7.85e-6
!SECTION, TYPE=SOLID, EGRP=Solid0, MATERIAL=STEEL
!EGROUP, EGRP=Solid0
1
2
...
!END

```

### 解析手順


FrontISTRの実行コマンド `fistr1` を実行します。

```
$ fistr1 -t 4
(4スレッドで実行)
```

```
##################################################################
#                         FrontISTR
#
##################################################################
---
version:    5.1.0
git_hash:   acab000c8c633b7b9d596424769e14363f720841
build:
  date:     2020-10-05T07:39:55Z
  MPI:      enabled
  OpenMP:   enabled
  option:   "-p --with-tools --with-refiner --with-metis --with-mumps --with-lapack --with-ml --with-mkl "
  HECMW_METIS_VER: 5
execute:
  date:       2020-10-07T10:01:16+0900
  processes:  1
  threads:    4
  cores:      4
  host:
    0: flow-p06
---
...
 Step control not defined! Using default step=1
 fstr_setup: OK
 Start visualize PSF 1 at timestep 0

 loading step=    1
 sub_step= 1,   current_time=  0.0000E+00, time_inc=  0.1000E+01
 loading_factor=    0.0000000   1.0000000
### 3x3 BLOCK CG, SSOR, 1
      1    1.903375E+00
      2    1.974378E+00
      3    2.534627E+00
...
...
   2967    1.080216E-08
   2968    1.004317E-08
   2969    9.375729E-09
### Relative residual = 9.39429E-09

### summary of linear solver
      2969 iterations      9.394286E-09
    set-up time      :     1.953022E-01
    solver time      :     5.704201E+01
    solver/comm time :     5.145826E-01
    solver/matvec    :     2.306329E+01
    solver/precond   :     2.632665E+01
    solver/1 iter    :     1.921253E-02
    work ratio (%)   :     9.909789E+01

 Start visualize PSF 1 at timestep 1
### FSTR_SOLVE_NLGEOM FINISHED!

 ====================================
    TOTAL TIME (sec) :     59.99
           pre (sec) :      0.71
         solve (sec) :     59.29
 ====================================
 FrontISTR Completed !!
```

`FrontISTR Completed !!` が表示されたら解析完了です。

### 解析結果

解析が完了すると、幾つかのファイルが新たに作成されます。

```
$ ls
0.log       hecmw_ctrl.dat  hinge.res.0.0            hinge_vis_psf.0001
FSTR.dbg.0  hecmw_vis.ini   hinge.res.0.1            hinge_vis_psf.0001.pvtu
FSTR.msg    hinge.cnt       hinge_vis_psf.0000
FSTR.sta    hinge.msh       hinge_vis_psf.0000.pvtu
```

`*.res.*` は結果データと言い、FrontISTRの解析結果が格納されています。REVOCAP_PrePost等で表示出来ます。

`*_vis_*` は可視化データと言い、汎用の可視化ソフトで表示できます。今回の例ではVTKフォーマットで出力しているので、ParaViewなどを使って表示します。

ミーゼス応力のコンター図をREVOCAP_PrePostで作成して図4.1.3に示します。
また、解析結果の数値データとして、解析結果ログファイルの一部を以下に示します。

![ミーゼス応力の解析結果](./media/tutorial01_03.png){.center width="350px"}
<div style="text-align: center;">
図4.1.3　ミーゼス応力の解析結果
</div>

#### 解析結果ログ `0.log`

<div style="height: 400px; overflow-y: scroll;">
```
 fstr_setup: OK
#### Result step=     0
 ##### Local Summary @Node    :Max/IdMax/Min/IdMin####
 //U1    0.0000E+00         1  0.0000E+00         1
 //U2    0.0000E+00         1  0.0000E+00         1
 //U3    0.0000E+00         1  0.0000E+00         1
 //E11   0.0000E+00         1  0.0000E+00         1
 //E22   0.0000E+00         1  0.0000E+00         1
 //E33   0.0000E+00         1  0.0000E+00         1
 //E12   0.0000E+00         1  0.0000E+00         1
 //E23   0.0000E+00         1  0.0000E+00         1
 //E31   0.0000E+00         1  0.0000E+00         1
 //S11   0.0000E+00         1  0.0000E+00         1
 //S22   0.0000E+00         1  0.0000E+00         1
 //S33   0.0000E+00         1  0.0000E+00         1
 //S12   0.0000E+00         1  0.0000E+00         1
 //S23   0.0000E+00         1  0.0000E+00         1
 //S31   0.0000E+00         1  0.0000E+00         1
 //SMS   0.0000E+00         1  0.0000E+00         1
 ##### Local Summary @Element :Max/IdMax/Min/IdMin####
 //E11   0.0000E+00         1  0.0000E+00         1
 //E22   0.0000E+00         1  0.0000E+00         1
 //E33   0.0000E+00         1  0.0000E+00         1
 //E12   0.0000E+00         1  0.0000E+00         1
 //E23   0.0000E+00         1  0.0000E+00         1
 //E31   0.0000E+00         1  0.0000E+00         1
 //S11   0.0000E+00         1  0.0000E+00         1
 //S22   0.0000E+00         1  0.0000E+00         1
 //S33   0.0000E+00         1  0.0000E+00         1
 //S12   0.0000E+00         1  0.0000E+00         1
 //S23   0.0000E+00         1  0.0000E+00         1
 //S31   0.0000E+00         1  0.0000E+00         1
 //SMS   0.0000E+00         1  0.0000E+00         1
 ##### Global Summary @Node    :Max/IdMax/Min/IdMin####
 //U1    0.0000E+00         1  0.0000E+00         1
 //U2    0.0000E+00         1  0.0000E+00         1
 //U3    0.0000E+00         1  0.0000E+00         1
 //E11   0.0000E+00         1  0.0000E+00         1
 //E22   0.0000E+00         1  0.0000E+00         1
 //E33   0.0000E+00         1  0.0000E+00         1
 //E12   0.0000E+00         1  0.0000E+00         1
 //E23   0.0000E+00         1  0.0000E+00         1
 //E31   0.0000E+00         1  0.0000E+00         1
 //S11   0.0000E+00         1  0.0000E+00         1
 //S22   0.0000E+00         1  0.0000E+00         1
 //S33   0.0000E+00         1  0.0000E+00         1
 //S12   0.0000E+00         1  0.0000E+00         1
 //S23   0.0000E+00         1  0.0000E+00         1
 //S31   0.0000E+00         1  0.0000E+00         1
 //SMS   0.0000E+00         1  0.0000E+00         1
 ##### Global Summary @Element :Max/IdMax/Min/IdMin####
 //E11   0.0000E+00         1  0.0000E+00         1
 //E22   0.0000E+00         1  0.0000E+00         1
 //E33   0.0000E+00         1  0.0000E+00         1
 //E12   0.0000E+00         1  0.0000E+00         1
 //E23   0.0000E+00         1  0.0000E+00         1
 //E31   0.0000E+00         1  0.0000E+00         1
 //S11   0.0000E+00         1  0.0000E+00         1
 //S22   0.0000E+00         1  0.0000E+00         1
 //S33   0.0000E+00         1  0.0000E+00         1
 //S12   0.0000E+00         1  0.0000E+00         1
 //S23   0.0000E+00         1  0.0000E+00         1
 //S31   0.0000E+00         1  0.0000E+00         1
 //SMS   0.0000E+00         1  0.0000E+00         1
#### Result step=     1
 ##### Local Summary @Node    :Max/IdMax/Min/IdMin####
 //U1    3.9115E-02     82452 -7.1083E-04     65233
 //U2    7.4504E-05       354 -5.8813E-04       696
 //U3    5.9493E-04        84 -5.8751E-03     61080
 //E11   1.3777E-03       130 -1.3653E-03     77625
 //E22   4.9199E-04        61 -5.4370E-04       102
 //E33   6.8634E-04     51036 -6.1176E-04     30070
 //E12   7.1556E-04     27808 -6.8093E-04     27863
 //E23   5.3666E-04        56 -5.4347E-04        82
 //E31   7.2396E-04     36168 -9.6621E-04       130
 //S11   3.8626E+02       130 -3.6387E+02     28580
 //S22   1.6628E+02       130 -1.5743E+02     28580
 //S33   1.6502E+02     30033 -1.5643E+02     28580
 //S12   5.7795E+01     27808 -5.4998E+01     27863
 //S23   4.3345E+01        56 -4.3896E+01        82
 //S31   5.8474E+01     36168 -7.8040E+01       130
 //SMS   2.8195E+02     77625  1.2755E-02     75112
 ##### Local Summary @Element :Max/IdMax/Min/IdMin####
 //E11   1.0731E-03     10485 -1.2123E-03     41779
 //E22   3.9143E-04     33536 -4.1389E-04     22892
 //E33   5.9415E-04     44563 -5.0497E-04     47965
 //E12   5.3264E-04      9163 -5.0405E-04      9161
 //E23   3.9226E-04     33024 -4.1464E-04     23465
 //E31   5.7633E-04     43142 -4.8019E-04      9571
 //S11   2.7231E+02      9180 -2.9763E+02     41779
 //S22   1.0792E+02      9180 -1.0656E+02     41779
 //S33   1.3921E+02     44569 -1.1431E+02     47974
 //S12   4.3021E+01      9163 -4.0712E+01      9161
 //S23   3.1683E+01     33024 -3.3490E+01     23465
 //S31   4.6550E+01     43142 -3.8785E+01      9571
 //SMS   2.4057E+02     41779  3.1383E-02     38687
 ##### Global Summary @Node    :Max/IdMax/Min/IdMin####
 //U1    3.9115E-02     82452 -7.1083E-04     65233
 //U2    7.4504E-05       354 -5.8813E-04       696
 //U3    5.9493E-04        84 -5.8751E-03     61080
 //E11   1.3777E-03       130 -1.3653E-03     77625
 //E22   4.9199E-04        61 -5.4370E-04       102
 //E33   6.8634E-04     51036 -6.1176E-04     30070
 //E12   7.1556E-04     27808 -6.8093E-04     27863
 //E23   5.3666E-04        56 -5.4347E-04        82
 //E31   7.2396E-04     36168 -9.6621E-04       130
 //S11   3.8626E+02       130 -3.6387E+02     28580
 //S22   1.6628E+02       130 -1.5743E+02     28580
 //S33   1.6502E+02     30033 -1.5643E+02     28580
 //S12   5.7795E+01     27808 -5.4998E+01     27863
 //S23   4.3345E+01        56 -4.3896E+01        82
 //S31   5.8474E+01     36168 -7.8040E+01       130
 //SMS   2.8195E+02     77625  1.2755E-02     75112
 ##### Global Summary @Element :Max/IdMax/Min/IdMin####
 //E11   1.0731E-03     10485 -1.2123E-03     41779
 //E22   3.9143E-04     33536 -4.1389E-04     22892
 //E33   5.9415E-04     44563 -5.0497E-04     47965
 //E12   5.3264E-04      9163 -5.0405E-04      9161
 //E23   3.9226E-04     33024 -4.1464E-04     23465
 //E31   5.7633E-04     43142 -4.8019E-04      9571
 //S11   2.7231E+02      9180 -2.9763E+02     41779
 //S22   1.0792E+02      9180 -1.0656E+02     41779
 //S33   1.3921E+02     44569 -1.1431E+02     47974
 //S12   4.3021E+01      9163 -4.0712E+01      9161
 //S23   3.1683E+01     33024 -3.3490E+01     23465
 //S31   4.6550E+01     43142 -3.8785E+01      9571
 //SMS   2.4057E+02     41779  3.1383E-02     38687
```
</div>
